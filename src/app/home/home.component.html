<div class="gifts-container home-wrapper">

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-text">
      <h1>Welcome to <span>BachatBuddy ğŸ›ï¸</span></h1>
      <p>Your AI-powered shopping buddy to save more with group deals in India!</p>
      <a routerLink="/products" class="explore-btn">ğŸ›’ Start Shopping</a>
    </div>
    <div class="hero-image-emoji" aria-label="Shopping together" role="img">
      <span class="emoji">ğŸ›ï¸ğŸ›’ğŸ‘«</span>
    </div>
  </section>

  <!-- How It Works Section -->
  <section class="how-it-works">
    <h2>ğŸ“¦ How It Works</h2>
    <div class="steps">
      <div class="step shadow-sm">
        <div class="icon">ğŸ”</div>
        <h4>Browse Products</h4>
        <p>Explore top electronics, groceries, fashion & more at the best prices.</p>
      </div>
      <div class="step shadow-sm">
        <div class="icon">ğŸ‘¥</div>
        <h4>Join a Group</h4>
        <p>Join others to unlock lower prices through group buying.</p>
      </div>
      <div class="step shadow-sm">
        <div class="icon">ğŸ’°</div>
        <h4>Save Big!</h4>
        <p>The more people join, the lower the price. You save more, together!</p>
      </div>
    </div>
  </section>

  <!-- Popular Group Deals (Standardized to Gifts Style) -->
  <section class="group-deals">
    <div class="gifts-header">
      <h2>ğŸ”¥ Popular Group Deals</h2>
      <p>Grab these hot items before the groups are full!</p>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="skeleton-grid">
      <div class="skeleton-card" *ngFor="let i of [1,2,3,4]"></div>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error-message">
      <p>{{ error }}</p>
    </div>

    <!-- Products Grid (Gifts Style) -->
    <div class="gifts-grid" *ngIf="!loading && !error">
      <div class="gift-card shadow-sm" *ngFor="let item of popularProducts" (click)="viewDetails(item.id)"
        style="cursor: pointer;">
        <span class="badge-savings">Save â‚¹{{ item.originalPrice - item.groupPrice }}</span>

        <div class="card-image">
          <img [src]="item.productImage" [alt]="item.productName">
          <span class="category-badge">{{ item.category || 'Deal' }}</span>
        </div>

        <div class="card-body">
          <h4>{{ item.productName }}</h4>
          <p class="description">{{ item.description || 'Join this group and save big on this amazing product!' }}</p>

          <div class="price-row">
            <span class="price">â‚¹{{ item.groupPrice }}</span>
            <span class="original-price">â‚¹{{ item.originalPrice }}</span>
          </div>

          <div class="progress-section">
            <div class="progress-container">
              <div class="progress-bar-inner" [style.width.%]="item.progressPercentage"></div>
            </div>
            <div class="joined-info">
              <span>ğŸ‘¥ {{ item.currentJoined }}/{{ item.totalNeeded }}</span>
              <span class="viewing-now pulse">ğŸ‘€ {{ item.viewingNow || 5 }}</span>
            </div>
          </div>

          <div class="action-buttons">
            <button class="btn-buy" (click)="$event.stopPropagation(); joinGroup(item)"
              [disabled]="item.isGroupComplete">
              {{ item.hasUserJoined ? 'Already Joined' : item.isGroupComplete ? 'Group Full' : 'Join Group' }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Ask Buddy CTA -->
  <section class="ask-buddy-cta shadow-sm">
    <h3>ğŸ’¬ Need help choosing?</h3>
    <p><strong>Ask Buddy</strong> to find the best deals for your needs!</p>
    <a routerLink="/assistant" class="btn-outline">Ask Buddy Now</a>
  </section>

</div>