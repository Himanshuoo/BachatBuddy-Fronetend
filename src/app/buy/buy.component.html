<div class="checkout-page">
  <div class="left-section">
    <!-- Step 1 -->
    <div class="card-section">
      <h3>1. LOGIN</h3>
      <div class="info-row">
        <p><strong>Hey {{ userName }}</strong>, thank you for ordering with us! üõçÔ∏è</p>
      </div>
    </div>

    <!-- Step 2 -->
    <div class="card-section">
      <h3>2. DELIVERY ADDRESS</h3>

      <div class="address-list">
        <div *ngFor="let a of addresses; let i = index" class="address-card"
          [class.selected]="i === selectedAddressIndex" (click)="selectAddress(i)">
          <input type="radio" [checked]="i === selectedAddressIndex" />
          <div>
            <strong>{{ a.name }}</strong> ({{ a.phone }})
            <p>{{ a.line1 }}<span *ngIf="a.line2">, {{ a.line2 }}</span></p>
            <p>{{ a.city }}, {{ a.state }} - {{ a.pincode }}</p>
          </div>
        </div>
      </div>

      <button class="link-btn" (click)="addNewAddress()">
        + Add New Address
      </button>
    </div>

    <!-- Step 3 -->
    <div class="card-section" *ngIf="product">
      <h3>3. ORDER SUMMARY</h3>
      <div class="order-item">
        <img [src]="product.pimage" alt="{{ product.pname }}" />
        <div class="order-info">
          <h4>{{ product.pname }}</h4>
          <p>Qty: 1</p>
          <p>Price: ‚Çπ{{ product.price }}</p>
          <p class="saving">You Save ‚Çπ{{ totalSavings }}</p>
        </div>
      </div>
    </div>

    <!-- Step 4 -->
    <div class="card-section">
      <h3>4. PAYMENT OPTIONS</h3>
      <div class="payment-options">
        <label>
          <input type="radio" name="payment" (click)="openPaymentDialog('UPI')"
            [checked]="selectedPaymentMode === 'UPI'" />
          UPI
          <span *ngIf="selectedPaymentMode === 'UPI' && paymentDetails">‚úÖ ({{ paymentDetails.upiId }})</span>
        </label>
        <label>
          <input type="radio" name="payment" (click)="openPaymentDialog('Card')"
            [checked]="selectedPaymentMode === 'Card'" />
          Credit/Debit Card
          <span *ngIf="selectedPaymentMode === 'Card' && paymentDetails">‚úÖ (Card Added)</span>
        </label>
        <label>
          <input type="radio" name="payment" (click)="selectedPaymentMode = 'COD'; paymentDetails = 'COD'"
            [checked]="selectedPaymentMode === 'COD'" />
          Cash on Delivery
        </label>
      </div>
      <button class="confirm-btn" (click)="confirmOrder()">Confirm Order</button>
    </div>
  </div>

  <app-payment-dialog *ngIf="showPaymentDialog" [mode]="selectedPaymentMode" (confirm)="onPaymentConfirmed($event)"
    (cancel)="cancelPaymentDialog()">
  </app-payment-dialog>

  <!-- RIGHT SIDE -->
  <div class="right-section" *ngIf="product">
    <div class="price-box">
      <h3>PRICE DETAILS</h3>
      <div class="price-row">
        <span>Price (1 item)</span>
        <span>‚Çπ{{ product.price }}</span>
      </div>
      <div class="price-row">
        <span>Discount</span>
        <span class="green">‚àí ‚Çπ{{ totalSavings }}</span>
      </div>
      <hr />
      <div class="price-row total">
        <strong>Total Payable</strong>
        <strong>‚Çπ{{ totalPrice }}</strong>
      </div>
      <div class="savings-text">
        üéâ You saved ‚Çπ{{ totalSavings }} on this order!
      </div>
    </div>
  </div>
</div>